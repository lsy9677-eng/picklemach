<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2026 ì§„ë¡€ëª¨ë˜, ì¥ìœ , ìœ¨í•˜ í´ëŸ½ ì°½ë‹¨ ê¸°ë…ëŒ€íšŒ - ê¹€í•´ì‹œ í”¼í´ë³¼ í˜‘íšŒ ì£¼ìµœ</title>
<link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
<style>
:root {
  --green:#1a6b3c; --green-light:#2d9c5c; --green-pale:#e8f5ee;
  --gold:#c9921a; --gold-light:#f0b429; --gold-pale:#fef9ec;
  --navy:#0f2d4a; --navy-light:#1a4a72;
  --red:#c0392b; --gray:#f4f5f7; --text:#1a1a2e;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Noto Sans KR',sans-serif;background:#e8edf2;color:var(--text);min-height:100vh;padding:20px;}

.tab-bar{display:flex;max-width:980px;margin:0 auto;border-radius:16px 16px 0 0;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.15);}
.tab-btn{flex:1;padding:16px;border:none;cursor:pointer;font-family:'Black Han Sans';font-size:1rem;transition:all .2s;}
.tab-btn.t1{background:#1a4a30;color:rgba(255,255,255,.6);}
.tab-btn.t2{background:#b8922a;color:rgba(255,255,255,.6);}
.tab-btn.t1.active{background:var(--green);color:white;}
.tab-btn.t2.active{background:var(--gold);color:white;}
.tab-content{display:none;}
.tab-content.active{display:block;}

.wrap{max-width:980px;margin:0 auto;background:white;border-radius:0 0 20px 20px;box-shadow:0 8px 40px rgba(0,0,0,.18);overflow:hidden;}
.section-title{font-family:'Black Han Sans';font-size:1.05rem;color:var(--navy);margin-bottom:14px;padding-bottom:8px;border-bottom:2px solid var(--green-pale);display:flex;align-items:center;gap:8px;}

/* POSTER */
.poster-hero{background:linear-gradient(160deg,var(--navy) 0%,var(--green) 65%,var(--green-light) 100%);padding:44px 40px 36px;position:relative;overflow:hidden;}
.poster-hero::before{content:'ğŸ“';position:absolute;font-size:200px;right:-10px;top:-20px;opacity:.07;line-height:1;}
.poster-hero::after{content:'';position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--gold-light),var(--gold),var(--gold-light));}
.badge-year{display:inline-block;background:var(--gold);color:white;font-family:'Black Han Sans';font-size:.85rem;letter-spacing:.1em;padding:4px 14px;border-radius:20px;margin-bottom:14px;}
.poster-title{font-family:'Black Han Sans';font-size:clamp(1.6rem,4vw,2.5rem);color:white;line-height:1.25;margin-bottom:6px;text-shadow:0 2px 8px rgba(0,0,0,.3);}
.poster-subtitle{font-size:1.1rem;color:rgba(255,255,255,.85);font-weight:500;}
.poster-icon{position:absolute;right:40px;top:50%;transform:translateY(-50%);font-size:80px;filter:drop-shadow(0 4px 12px rgba(0,0,0,.4));}
.poster-body{padding:32px 36px;}
.info-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:28px;}
.info-card{background:var(--gray);border-radius:14px;padding:18px 20px;border-left:4px solid var(--green);display:flex;align-items:flex-start;gap:14px;}
.info-card.full{grid-column:1/-1;}
.info-icon{font-size:1.6rem;flex-shrink:0;margin-top:2px;}
.info-label{font-size:.72rem;font-weight:700;color:var(--green);text-transform:uppercase;letter-spacing:.08em;margin-bottom:4px;}
.info-value{font-size:1rem;font-weight:700;line-height:1.5;}
.info-sub{font-size:.82rem;color:#666;margin-top:3px;}
.rule-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:28px;}
.rule-card{background:var(--green-pale);border-radius:12px;padding:16px;text-align:center;}
.rule-icon{font-size:1.5rem;margin-bottom:6px;}
.rule-label{font-size:.72rem;font-weight:700;color:var(--green);margin-bottom:4px;}
.rule-val{font-size:.92rem;font-weight:700;}
.award-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:28px;}
.award-card{border-radius:14px;padding:18px 12px;text-align:center;}
.award-card:nth-child(1){background:linear-gradient(135deg,#fff3cd,#ffd700);border:2px solid #f0c040;}
.award-card:nth-child(2){background:linear-gradient(135deg,#f0f0f0,#c0c0c0);border:2px solid #aaa;}
.award-card:nth-child(3){background:linear-gradient(135deg,#fde8cc,#cd7f32);border:2px solid #b87333;color:white;}
.award-medal{font-size:2rem;margin-bottom:6px;}
.award-rank{font-family:'Black Han Sans';font-size:1rem;margin-bottom:4px;}
.award-prize{font-size:1.1rem;font-weight:900;}
.award-desc{font-size:.78rem;margin-top:3px;opacity:.75;}
.notice-box{background:#fff8e1;border:1px solid #f0c040;border-radius:12px;padding:16px 20px;font-size:.84rem;color:#6b5800;line-height:1.7;}
.poster-footer{background:var(--navy);color:rgba(255,255,255,.7);text-align:center;padding:16px;font-size:.82rem;}
.poster-footer strong{color:white;}

/* BRACKET */
.bracket-header{background:linear-gradient(135deg,var(--navy),var(--navy-light));padding:24px 32px;color:white;display:flex;align-items:center;justify-content:space-between;border-bottom:3px solid var(--gold);}
.bracket-header h2{font-family:'Black Han Sans';font-size:1.4rem;}
.bracket-header p{font-size:.83rem;opacity:.75;margin-top:3px;}
.hdr-btns{display:flex;gap:8px;flex-wrap:wrap;}
.btn-hdr{padding:8px 16px;border:none;border-radius:8px;font-family:'Black Han Sans';font-size:.82rem;cursor:pointer;}
.btn-print{background:var(--gold);color:white;}
.btn-admin{background:rgba(255,255,255,.15);color:white;border:1px solid rgba(255,255,255,.3);}
.btn-admin.on{background:var(--red);border-color:var(--red);}
.bracket-body{padding:28px 24px;}

.schedule-table{width:100%;border-collapse:collapse;font-size:.88rem;}
.schedule-table th{background:var(--navy);color:white;padding:10px 14px;text-align:center;font-weight:700;}
.schedule-table th:first-child{border-radius:8px 0 0 0;}
.schedule-table th:last-child{border-radius:0 8px 0 0;}
.schedule-table td{padding:10px 14px;border-bottom:1px solid #eee;text-align:center;line-height:1.6;}
.schedule-table tr:nth-child(even) td{background:var(--gray);}
.schedule-table tr:last-child td{border-bottom:none;}
.schedule-table td:first-child{font-family:'Black Han Sans';font-size:1rem;color:var(--green);white-space:nowrap;}
.time-tag{display:inline-block;background:var(--green-pale);color:var(--green);font-weight:700;font-size:.75rem;padding:2px 8px;border-radius:20px;margin:1px 2px;}
.time-tag.main{background:#fdecea;color:var(--red);}
.time-tag.gold{background:var(--gold-pale);color:var(--gold);}

.prelim-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:14px;}
.group-box{border:2px solid #dde4ea;border-radius:12px;overflow:hidden;}
.group-header{color:white;text-align:center;padding:7px 10px;font-family:'Black Han Sans';font-size:.85rem;}
.gh-a{background:var(--green);}
.gh-b{background:var(--navy-light);}
.gh-dim{opacity:.72;}
.group-match{padding:8px 10px;font-size:.82rem;text-align:center;color:#555;}
.team-chip{display:inline-block;background:var(--green-pale);color:var(--green);font-weight:700;border-radius:5px;padding:2px 7px;font-size:.8rem;margin:1px;}
.team-chip.nb{background:#e8edf5;color:var(--navy);}

.venue-badge{display:inline-flex;align-items:center;gap:4px;background:#e8edf5;border-radius:6px;padding:3px 10px;font-size:.72rem;color:var(--navy);font-weight:700;margin-bottom:8px;}

/* ADMIN PANEL */
.admin-panel{background:#fffbe6;border:2px solid var(--gold);border-radius:14px;padding:20px;margin-bottom:24px;}
.admin-panel h4{font-family:'Black Han Sans';color:var(--gold);margin-bottom:14px;font-size:1rem;}
.team-input-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;}
.team-input-item{display:flex;flex-direction:column;gap:4px;}
.team-input-item label{font-size:.72rem;font-weight:700;color:var(--navy);}
.team-input-item input{padding:7px 10px;border:1.5px solid #ddd;border-radius:8px;font-size:.85rem;font-family:'Noto Sans KR';outline:none;}
.team-input-item input:focus{border-color:var(--gold);}
.admin-save-btn{margin-top:14px;padding:10px 24px;background:var(--green);color:white;border:none;border-radius:10px;font-family:'Black Han Sans';font-size:.9rem;cursor:pointer;}
.admin-reset-btn{margin-top:14px;margin-left:8px;padding:10px 20px;background:var(--gray);color:#666;border:1px solid #ddd;border-radius:10px;font-family:'Black Han Sans';font-size:.9rem;cursor:pointer;}

/* BRACKET CANVAS WRAPPER */
.tourney-outer{overflow-x:auto;overflow-y:hidden;padding-bottom:10px;}
#bracketCanvas{display:block;cursor:default;}

.note-line{font-size:.78rem;color:#888;text-align:center;margin-top:12px;font-style:italic;}

/* Firebase ì„¤ì • ì•ˆë‚´ ëª¨ë‹¬ */
.fb-guide{background:#f0f7ff;border:2px solid #1a6b9a;border-radius:14px;padding:20px;margin-bottom:20px;}
.fb-guide h4{font-family:'Black Han Sans';color:#1a6b9a;margin-bottom:10px;}
.fb-guide code{background:#1a1a2e;color:#7ec8e3;padding:2px 6px;border-radius:4px;font-size:.82rem;}
.fb-guide pre{background:#1a1a2e;color:#c8e6c9;padding:14px;border-radius:10px;font-size:.78rem;line-height:1.7;overflow-x:auto;margin:8px 0;}

@media(max-width:600px){
  .info-grid,.rule-grid,.award-grid{grid-template-columns:1fr;}
  .info-card.full{grid-column:auto;}
  .prelim-grid{grid-template-columns:repeat(2,1fr);}
  .poster-icon{display:none;}
  .poster-body,.bracket-body{padding:20px 16px;}
  .team-input-grid{grid-template-columns:repeat(2,1fr);}
}
@media print{
  body{background:white;padding:0;}
  .tab-bar,.hdr-btns,.admin-panel,.fb-guide{display:none!important;}
  .tab-content{display:block!important;page-break-after:always;}
  .wrap{box-shadow:none;border-radius:0;}
}
</style>
</head>
<body>

<div class="tab-bar">
  <button class="tab-btn t1 active" onclick="switchTab('poster')">ğŸ“¢ ëŒ€íšŒ ê³µì§€ í¬ìŠ¤í„°</button>
  <button class="tab-btn t2" onclick="switchTab('bracket')">ğŸ† ì‹œê°„í‘œ &amp; ëŒ€ì§„í‘œ</button>
</div>

<!-- POSTER -->
<div id="poster" class="tab-content active">
<div class="wrap">
  <div class="poster-hero">
    <div class="badge-year">2026 ì§„ë¡€ëª¨ë˜, ì¥ìœ , ìœ¨í•˜ í´ëŸ½ ì°½ë‹¨ ê¸°ë…ëŒ€íšŒ </div>
    <div class="poster-title">2026 ì§„ë¡€ëª¨ë˜, ì¥ìœ , ìœ¨í•˜ í´ëŸ½ ì°½ë‹¨ ê¸°ë…ëŒ€íšŒ - ê¹€í•´ì‹œ í”¼í´ë³¼ í˜‘íšŒ ì£¼ìµœ<br>ì‹ ì¸ë¶€(í˜¼í•©ë³µì‹)</div>
    <div class="poster-subtitle">Gimhae Pickleball Association Cup</div>
    <div class="poster-icon">ğŸ“</div>
  </div>
  <div class="poster-body">
    <div class="info-grid">
      <div class="info-card">
        <div class="info-icon">ğŸ“…</div>
        <div>
          <div class="info-label">ì¼ì‹œ</div>
          <div class="info-value">2026.02.22 (ì¼)<br>ì˜¤í›„ 12:00 ì‹œì‘</div>
          <div class="info-sub">â€» 11:40 ëŒ€í‘œì íšŒì˜</div>
        </div>
      </div>
      <div class="info-card">
        <div class="info-icon">ğŸ’°</div>
        <div>
          <div class="info-label">ì°¸ê°€ë¹„</div>
          <div class="info-value">íŒ€ë‹¹ 40,000ì›</div>
          <div class="info-sub">ğŸ‘¥ ì´ 16íŒ€ ì°¸ê°€</div>
        </div>
      </div>
      <div class="info-card full">
        <div class="info-icon">ğŸ“</div>
        <div>
          <div class="info-label">ì¥ì†Œ (ì´ 4ë©´ ìš´ì˜)</div>
          <div class="info-value">ğŸ¢ ì§„ë¡€ ì‹¤ë‚´ ì²´ìœ¡ê´€ (1Â·2ë²ˆ ì½”íŠ¸)<br>ğŸŒ¿ ìœ¨í•˜ ìœ ì ê³µì› ë°°ë“œë¯¼í„´ì¥ (3Â·4ë²ˆ ì½”íŠ¸)</div>
        </div>
      </div>
    </div>
    <div class="section-title">ğŸ¸ ê²½ê¸° ë°©ì‹</div>
    <div class="rule-grid">
      <div class="rule-card"><div class="rule-icon">ğŸ“‹</div><div class="rule-label">ì˜ˆì„ </div><div class="rule-val">2íŒ€ 1ê²½ê¸°<br><small style="font-weight:400;color:#888;">íƒˆë½ ì—†ìŒ / ìˆœìœ„ ê²°ì •ì „</small></div></div>
      <div class="rule-card"><div class="rule-icon">âš”ï¸</div><div class="rule-label">ë³¸ì„ </div><div class="rule-val">16ê°• í† ë„ˆë¨¼íŠ¸<br><small style="font-weight:400;color:#888;">ë‹¨íŒ ìŠ¹ë¶€</small></div></div>
      <div class="rule-card"><div class="rule-icon">ğŸ¯</div><div class="rule-label">ê²½ê¸° ë°©ì‹</div><div class="rule-val">15ì  1ê²Œì„<br><small style="font-weight:400;color:#888;">ë…¸ ë“€ìŠ¤</small></div></div>
    </div>
    <div class="section-title">ğŸ– ì‹œìƒ ì•ˆë‚´</div>
    <div class="award-grid">
      <div class="award-card"><div class="award-medal">ğŸ¥‡</div><div class="award-rank">ìš°ìŠ¹</div><div class="award-prize">20ë§Œì›</div><div class="award-desc">+ ìƒíŒ¨</div></div>
      <div class="award-card"><div class="award-medal">ğŸ¥ˆ</div><div class="award-rank">ì¤€ìš°ìŠ¹</div><div class="award-prize">10ë§Œì›</div><div class="award-desc">+ ìƒíŒ¨</div></div>
      <div class="award-card"><div class="award-medal">ğŸ¥‰</div><div class="award-rank">ê³µë™ 3ìœ„</div><div class="award-prize">5ë§Œì›</div><div class="award-desc">+ ìƒíŒ¨</div></div>
    </div>
    <div class="section-title">ğŸ“Œ ìœ ì˜ì‚¬í•­</div>
    <div class="notice-box">
      âš ï¸ ê²½ê¸° ì§„í–‰ ìƒí™©ì— ë”°ë¼ ì¼ì • ë° ë°©ì‹ ì¼ë¶€ê°€ ë³€ê²½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
      ğŸ• ëŒ€í‘œì íšŒì˜ëŠ” 11ì‹œ 40ë¶„ ì§„ë¡€ ì‹¤ë‚´ ì²´ìœ¡ê´€ì—ì„œ ì§„í–‰ë©ë‹ˆë‹¤.<br>
      ğŸ“ ë¬¸ì˜: ê¹€í•´ì‹œ í”¼í´ë³¼ í˜‘íšŒ
    </div>
  </div>
  <div class="poster-footer">ì£¼ìµœ Â· ì£¼ê´€ <strong>ê¹€í•´ì‹œ í”¼í´ë³¼ í˜‘íšŒ</strong> &nbsp;|&nbsp; - ê¹€í•´ì‹œ í”¼í´ë³¼ í˜‘íšŒ ì£¼ìµœ</div>
</div>
</div>

<!-- BRACKET -->
<div id="bracket" class="tab-content">
<div class="wrap">
  <div class="bracket-header">
    <div>
      <h2>ğŸ† ì‹œê°„í‘œ &amp; ëŒ€ì§„í‘œ</h2>
      <p>2026.02.22 (ì¼) Â· 2026 ì§„ë¡€ëª¨ë˜, ì¥ìœ , ìœ¨í•˜ í´ëŸ½ ì°½ë‹¨ ê¸°ë…ëŒ€íšŒ - ê¹€í•´ì‹œ í”¼í´ë³¼ í˜‘íšŒ ì£¼ìµœ -ì‹ ì¸ë¶€(í˜¼í•©ë³µì‹) (16íŒ€)</p>
    </div>
    <div class="hdr-btns">
      <button class="btn-hdr btn-admin" id="adminToggleBtn" onclick="toggleAdmin()">ğŸ”’ ê´€ë¦¬ì</button>
      <button class="btn-hdr btn-print" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„</button>
    </div>
  </div>

  <div class="bracket-body">

    <!-- Firebase ì—°ê²° ìƒíƒœ -->
    <div id="fbGuide" style="display:none; background:#e8f5ee; border:1.5px solid var(--green); border-radius:10px; padding:12px 16px; margin-bottom:20px; font-size:.85rem; color:var(--green); font-weight:700;">
      ğŸŸ¢ Firebase ì‹¤ì‹œê°„ ì—°ê²°ë¨ â€” ëª¨ë“  ê¸°ê¸°ì—ì„œ ë™ê¸°í™” ì¤‘
    </div>

    <!-- ì‹œê°„í‘œ -->
    <div style="margin-bottom:32px;">
      <div class="section-title">â° ê²½ê¸° ì‹œê°„í‘œ Â· 2026.02.22 (ì¼)</div>
      <table class="schedule-table">
        <thead>
          <tr>
            <th>ì‹œê°„</th>
            <th>ğŸ¢ ì§„ë¡€ ì‹¤ë‚´ ì²´ìœ¡ê´€<br><small style="font-weight:400;opacity:.8;">1Â·2ë²ˆ ì½”íŠ¸</small></th>
            <th>ğŸŒ¿ ìœ¨í•˜ ìœ ì ê³µì›<br><small style="font-weight:400;opacity:.8;">3Â·4ë²ˆ ì½”íŠ¸</small></th>
            <th>ë¹„ê³ </th>
          </tr>
        </thead>
        <tbody>
          <tr><td>12:00</td><td>ì˜ˆì„  <span class="time-tag">Aì¡°</span><span class="time-tag">Bì¡°</span><br><small style="color:#888;">1~4ë²ˆ íŒ€</small></td><td>ì˜ˆì„  <span class="time-tag">Eì¡°</span><span class="time-tag">Fì¡°</span><br><small style="color:#888;">9~12ë²ˆ íŒ€</small></td><td>ìˆœìœ„ ê²°ì •ì „</td></tr>
          <tr><td>12:30</td><td>ì˜ˆì„  <span class="time-tag">Cì¡°</span><span class="time-tag">Dì¡°</span><br><small style="color:#888;">5~8ë²ˆ íŒ€</small></td><td>ì˜ˆì„  <span class="time-tag">Gì¡°</span><span class="time-tag">Hì¡°</span><br><small style="color:#888;">13~16ë²ˆ íŒ€</small></td><td>ìˆœìœ„ ê²°ì •ì „</td></tr>
          <tr><td>13:00</td><td>16ê°• <span class="time-tag main">1ê²½ê¸°</span><span class="time-tag main">2ê²½ê¸°</span></td><td>16ê°• <span class="time-tag main">5ê²½ê¸°</span><span class="time-tag main">6ê²½ê¸°</span></td><td>ë³¸ì„  ì‹œì‘</td></tr>
          <tr><td>13:30</td><td>16ê°• <span class="time-tag main">3ê²½ê¸°</span><span class="time-tag main">4ê²½ê¸°</span></td><td>16ê°• <span class="time-tag main">7ê²½ê¸°</span><span class="time-tag main">8ê²½ê¸°</span></td><td>ë³¸ì„ </td></tr>
          <tr><td>14:10</td><td colspan="2" style="color:var(--green);font-weight:700;">8ê°•ì „ (4ê²½ê¸° ë™ì‹œ) â€” ì½”íŠ¸ 1Â·2Â·3Â·4 í™œìš©</td><td>â€”</td></tr>
          <tr><td>14:50</td><td colspan="2" style="color:var(--gold);font-weight:700;">4ê°•ì „ (2ê²½ê¸°) â€” ì½”íŠ¸ 1Â·2 í™œìš©</td><td>â€”</td></tr>
          <tr><td>15:30</td><td colspan="2" style="color:var(--red);font-weight:700;">ê²°ìŠ¹ì „ ë° 3Â·4ìœ„ì „ â€” ì½”íŠ¸ 1Â·2 í™œìš©</td><td><span class="time-tag gold">ê²°ìŠ¹</span></td></tr>
          <tr><td>16:10</td><td colspan="2" style="font-weight:700;">ğŸ† ì‹œìƒ ë° ííšŒ â€” ë©”ì¸ ê²½ê¸°ì¥</td><td>ííšŒ</td></tr>
        </tbody>
      </table>
    </div>

    <!-- ì˜ˆì„  -->
    <div style="margin-bottom:32px;">
      <div class="section-title">ğŸ“‹ ì˜ˆì„  ëŒ€ì§„í‘œ (8ê°œì¡°)</div>
      <div class="venue-badge">ğŸ¢ ì§„ë¡€ ì‹¤ë‚´ ì²´ìœ¡ê´€ â€” 12:00</div>
      <div class="prelim-grid" style="margin-bottom:14px;">
        <div class="group-box"><div class="group-header gh-a">Aì¡° (ì½”íŠ¸ 1)</div><div class="group-match" id="pm-A"></div></div>
        <div class="group-box"><div class="group-header gh-a">Bì¡° (ì½”íŠ¸ 2)</div><div class="group-match" id="pm-B"></div></div>
        <div class="group-box" style="border-color:#c9d4df;"><div class="group-header gh-a gh-dim">Cì¡° (ì½”íŠ¸ 1) â€” 12:30</div><div class="group-match" id="pm-C"></div></div>
        <div class="group-box" style="border-color:#c9d4df;"><div class="group-header gh-a gh-dim">Dì¡° (ì½”íŠ¸ 2) â€” 12:30</div><div class="group-match" id="pm-D"></div></div>
      </div>
      <div class="venue-badge">ğŸŒ¿ ìœ¨í•˜ ìœ ì ê³µì› â€” 12:00</div>
      <div class="prelim-grid">
        <div class="group-box"><div class="group-header gh-b">Eì¡° (ì½”íŠ¸ 3)</div><div class="group-match" id="pm-E"></div></div>
        <div class="group-box"><div class="group-header gh-b">Fì¡° (ì½”íŠ¸ 4)</div><div class="group-match" id="pm-F"></div></div>
        <div class="group-box" style="border-color:#c9d4df;"><div class="group-header gh-b gh-dim">Gì¡° (ì½”íŠ¸ 3) â€” 12:30</div><div class="group-match" id="pm-G"></div></div>
        <div class="group-box" style="border-color:#c9d4df;"><div class="group-header gh-b gh-dim">Hì¡° (ì½”íŠ¸ 4) â€” 12:30</div><div class="group-match" id="pm-H"></div></div>
      </div>
      <p class="note-line">ì˜ˆì„ ì€ íƒˆë½ ì—†ì´ ëª¨ë“  íŒ€ì´ ìˆœìœ„ ê²°ì •ì „ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤</p>
    </div>

    <!-- ê´€ë¦¬ì íŒ€ ì…ë ¥ -->
    <div class="admin-panel" id="adminPanel" style="display:none;">
      <h4>âš™ï¸ ê´€ë¦¬ì â€” íŒ€ëª… ì…ë ¥ (16íŒ€)</h4>
      <div class="team-input-grid" id="teamInputGrid"></div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-top:14px;">
        <button class="admin-save-btn" style="margin-top:0;" onclick="saveTeams()">âœ… ì €ì¥ &amp; ë°˜ì˜</button>
        <button class="admin-reset-btn" style="margin-top:0;" onclick="resetAll()">â†º ì „ì²´ ì´ˆê¸°í™”</button>
        <div id="syncStatus" style="font-size:.8rem;color:#888;margin-left:4px;"></div>
      </div>
      <div style="margin-top:10px;font-size:.8rem;color:#888;">ğŸ‘† ëŒ€ì§„í‘œì—ì„œ íŒ€ ì´ë¦„ì„ í´ë¦­í•˜ë©´ ìŠ¹ìë¡œ ì„ íƒë©ë‹ˆë‹¤.</div>
    </div>

    <!-- ë³¸ì„  í† ë„ˆë¨¼íŠ¸ Canvas -->
    <div>
      <div class="section-title">âš”ï¸ ë³¸ì„  í† ë„ˆë¨¼íŠ¸ ëŒ€ì§„í‘œ</div>
      <div class="tourney-outer">
        <canvas id="bracketCanvas"></canvas>
      </div>
      <p class="note-line" id="bracketNote">â€» ì˜ˆì„  ìˆœìœ„ì— ë”°ë¥¸ 16ê°• ëŒ€ì§„ì€ ëŒ€í‘œì íšŒì˜ì—ì„œ í™•ì •ë©ë‹ˆë‹¤</p>
    </div>

  </div>
</div>
</div>

<script>
// ============================================================
// FIREBASE CONFIG
// ============================================================
const FIREBASE_CONFIG = {
  apiKey: "AIzaSyA7Am8MvQG8anRxe11LHtLznAJgX_hP4BY",
  authDomain: "picklemach-c8810.firebaseapp.com",
  databaseURL: "https://picklemach-c8810-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "picklemach-c8810",
  storageBucket: "picklemach-c8810.firebasestorage.app",
  messagingSenderId: "100091044721",
  appId: "1:100091044721:web:3d124150b1978b63edccd0"
};
const FB_PATH = 'pkl2026';
const FB_ENABLED = true;

// ============================================================
// STATE
// ============================================================
const STORAGE_KEY = 'pkl2026_data';
let state = { teams: Array(16).fill(''), winners: {} };
let isAdmin = false;
let db = null; // Firebase db reference

// ============================================================
// FIREBASE INIT (ë™ì  ë¡œë“œ)
// ============================================================
async function initFirebase() {
  if (!FB_ENABLED) return false;
  try {
    const { initializeApp } = await import('https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js');
    const { getDatabase, ref, onValue, set } = await import('https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js');
    const app = initializeApp(FIREBASE_CONFIG);
    db = getDatabase(app);
    window._fbSet = set;
    window._fbRef = ref;

    // ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ
    onValue(ref(db, FB_PATH), (snap) => {
      const val = snap.val();
      if (val) {
        if (val.teams && Array.isArray(val.teams)) state.teams = val.teams;
        if (val.winners) state.winners = val.winners;
        renderAll();
      }
    });

    setSyncStatus('ğŸŸ¢ Firebase ì—°ê²°ë¨ â€” ì‹¤ì‹œê°„ ë™ê¸°í™” ì¤‘');
    document.getElementById('fbGuide').style.display = 'block';
    return true;
  } catch(e) {
    console.warn('Firebase ì—°ê²° ì‹¤íŒ¨:', e);
    setSyncStatus('âš ï¸ Firebase ì—°ê²° ì‹¤íŒ¨ â€” ë¡œì»¬ ëª¨ë“œ');
    return false;
  }
}

async function fbSave() {
  if (db && window._fbSet && window._fbRef) {
    try {
      await window._fbSet(window._fbRef(db, FB_PATH), {
        teams: state.teams,
        winners: state.winners,
        updatedAt: Date.now()
      });
      setSyncStatus('âœ… Firebase ì €ì¥ ì™„ë£Œ Â· ' + new Date().toLocaleTimeString());
    } catch(e) {
      setSyncStatus('âŒ ì €ì¥ ì‹¤íŒ¨ â€” ë¡œì»¬ì—ë§Œ ì €ì¥ë¨');
      localSave();
    }
  } else {
    localSave();
  }
}

function localSave() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  setSyncStatus('ğŸ’¾ ë¡œì»¬ ì €ì¥ë¨');
}

function setSyncStatus(msg) {
  const el = document.getElementById('syncStatus');
  if (el) el.textContent = msg;
}

function loadLocal() {
  try {
    const s = JSON.parse(localStorage.getItem(STORAGE_KEY));
    if (s) state = { ...state, ...s };
  } catch {}
}

// ============================================================
// ADMIN
// ============================================================
function toggleAdmin() {
  if (!isAdmin) {
    const pwd = prompt('ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸:');
    if (pwd !== '1234') { alert('ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.'); return; }
    isAdmin = true;
  } else {
    isAdmin = false;
  }
  document.getElementById('adminToggleBtn').textContent = isAdmin ? 'ğŸ”“ ê´€ë¦¬ì ON' : 'ğŸ”’ ê´€ë¦¬ì';
  document.getElementById('adminToggleBtn').classList.toggle('on', isAdmin);
  document.getElementById('adminPanel').style.display = isAdmin ? 'block' : 'none';
  if (isAdmin) buildTeamInputs();
  renderAll();
}

const GROUP_PAIRS = [
  ['Aì¡°',0,1],['Bì¡°',2,3],['Cì¡°',4,5],['Dì¡°',6,7],
  ['Eì¡°',8,9],['Fì¡°',10,11],['Gì¡°',12,13],['Hì¡°',14,15]
];

function buildTeamInputs() {
  const grid = document.getElementById('teamInputGrid');
  grid.innerHTML = '';
  for (let i = 0; i < 16; i++) {
    const d = document.createElement('div');
    d.className = 'team-input-item';
    d.innerHTML = `<label>${i+1}ë²ˆ íŒ€</label>
      <input type="text" id="ti_${i}" value="${escHtml(state.teams[i]||'')}" placeholder="${i+1}ë²ˆ íŒ€">`;
    grid.appendChild(d);
  }
}

function escHtml(s){ return s.replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]||c)); }

function saveTeams() {
  for (let i = 0; i < 16; i++) {
    const v = document.getElementById(`ti_${i}`);
    state.teams[i] = v ? v.value.trim() : '';
  }
  state.winners = {};
  fbSave();
  renderAll();
}

function resetAll() {
  if (!confirm('ëª¨ë“  íŒ€ëª…ê³¼ ê²½ê¸° ê²°ê³¼ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  state.teams = Array(16).fill('');
  state.winners = {};
  fbSave();
  buildTeamInputs();
  renderAll();
}

function tname(idx) {
  if (idx === null || idx === undefined) return '';
  return state.teams[idx] || `${idx+1}ë²ˆíŒ€`;
}

// ============================================================
// PRELIM
// ============================================================
function renderPrelim() {
  GROUP_PAIRS.forEach(([grp, i1, i2], gi) => {
    const el = document.getElementById(`pm-${grp[0]}`);
    if (!el) return;
    const cls = gi >= 4 ? 'nb' : '';
    el.innerHTML = `<span class="team-chip ${cls}">${tname(i1)}</span> vs <span class="team-chip ${cls}">${tname(i2)}</span>`;
  });
}

// ============================================================
// BRACKET LOGIC
// ============================================================
const R16_SEEDS  = [[0,3],[2,1],[4,7],[6,5],[8,11],[10,9],[12,15],[14,13]];
const R16_LABELS = [
  ['Aì¡°1ìœ„','Bì¡°2ìœ„'],['Bì¡°1ìœ„','Aì¡°2ìœ„'],
  ['Cì¡°1ìœ„','Dì¡°2ìœ„'],['Dì¡°1ìœ„','Cì¡°2ìœ„'],
  ['Eì¡°1ìœ„','Fì¡°2ìœ„'],['Fì¡°1ìœ„','Eì¡°2ìœ„'],
  ['Gì¡°1ìœ„','Hì¡°2ìœ„'],['Hì¡°1ìœ„','Gì¡°2ìœ„'],
];

function getMatchup(round, mi) {
  if (round==='r16') return { t: R16_SEEDS[mi], labels: R16_LABELS[mi] };
  if (round==='qf') {
    const a=getWinner('r16',mi*2), b=getWinner('r16',mi*2+1);
    return { t:[a,b], labels:[`16ê°• ${mi*2+1}ìŠ¹`,`16ê°• ${mi*2+2}ìŠ¹`] };
  }
  if (round==='sf') {
    const a=getWinner('qf',mi*2), b=getWinner('qf',mi*2+1);
    return { t:[a,b], labels:[`8ê°• ${mi*2+1}ìŠ¹`,`8ê°• ${mi*2+2}ìŠ¹`] };
  }
  if (round==='fin') {
    return { t:[getWinner('sf',0),getWinner('sf',1)], labels:['4ê°• 1ìŠ¹','4ê°• 2ìŠ¹'] };
  }
  if (round==='3rd') {
    return { t:[getLoser('sf',0),getLoser('sf',1)], labels:['4ê°• 1íŒ¨','4ê°• 2íŒ¨'] };
  }
  return { t:[null,null], labels:['TBD','TBD'] };
}

function getWinner(round, mi) {
  const k=`${round}_${mi}`, w=state.winners[k];
  if (w===undefined||w===null) return null;
  return getMatchup(round,mi).t[w];
}
function getLoser(round, mi) {
  const k=`${round}_${mi}`, w=state.winners[k];
  if (w===undefined||w===null) return null;
  return getMatchup(round,mi).t[1-w];
}

function setWinner(round, mi, si) {
  if (!isAdmin) return;
  const k=`${round}_${mi}`;
  if (state.winners[k]===si) { delete state.winners[k]; cascadeReset(round,mi); }
  else { state.winners[k]=si; cascadeReset(round,mi); }
  fbSave();
  drawBracket();
}

function cascadeReset(round, mi) {
  if (round==='r16') { const q=Math.floor(mi/2); delete state.winners[`qf_${q}`]; cascadeReset('qf',q); }
  else if (round==='qf') { const s=Math.floor(mi/2); delete state.winners[`sf_${s}`]; cascadeReset('sf',s); delete state.winners['3rd']; }
  else if (round==='sf') { delete state.winners['fin']; delete state.winners['3rd']; }
}

// ============================================================
// CANVAS BRACKET DRAWING
// ============================================================
const C = {
  BOX_W: 160,
  BOX_H: 80,   // label(18) + slot(31)*2
  SLOT_H: 31,
  LABEL_H: 18,
  GAP_Y: 10,   // gap between boxes within same round
  COL_GAP: 48, // horizontal gap between columns (connector space)
  PAD_TOP: 36, // space for round header
  PAD_LEFT: 10,
  PAD_RIGHT: 10,
  PAD_BOT: 20,
};

// Number of matches per round
const ROUNDS = [
  { id:'r16', n:8, label:'16ê°•  13:00~13:30', color:'#1a4a72', bg:'#e8edf5' },
  { id:'qf',  n:4, label:'8ê°•  14:10',        color:'#1a6b3c', bg:'#e8f5ee' },
  { id:'sf',  n:2, label:'4ê°•  14:50',        color:'#c9921a', bg:'#fef9ec' },
  { id:'fin', n:1, label:'ê²°ìŠ¹  15:30',        color:'#c0392b', bg:'#fdecea' },
];

// For each round, compute the total height occupied by its matches
// colH(n) = n*BOX_H + (n-1)*GAP_Y
function colMatchesH(n) { return n * C.BOX_H + (n-1) * C.GAP_Y; }

// Total canvas height = max round height + PAD_TOP + PAD_BOT
// Plus extra for 3rd place box below final
function computeCanvasSize() {
  const maxH = colMatchesH(8);
  const totalH = C.PAD_TOP + maxH + C.PAD_BOT + C.BOX_H + 30 + 22; // +3rd place
  const totalW = C.PAD_LEFT + 4 * C.BOX_W + 3 * C.COL_GAP + C.PAD_RIGHT;
  return { w: totalW, h: totalH };
}

// Get the y-center of a match box within its column
// Matches in R16 are evenly spaced; later rounds are centered between their pair
function getBoxY(roundIdx, matchIdx) {
  // r16: all 8 boxes, evenly spaced from PAD_TOP
  const r16_top = C.PAD_TOP;
  if (roundIdx === 0) {
    return r16_top + matchIdx * (C.BOX_H + C.GAP_Y);
  }
  // For each subsequent round, box is centered between the two boxes it comes from
  const prevBoxY_a = getBoxY(roundIdx-1, matchIdx*2);
  const prevBoxY_b = getBoxY(roundIdx-1, matchIdx*2+1);
  return (prevBoxY_a + prevBoxY_b) / 2;
}

// Get x position for column (left edge of box)
function getColX(colIdx) {
  return C.PAD_LEFT + colIdx * (C.BOX_W + C.COL_GAP);
}

let hitBoxes = []; // for click detection: [{round,mi,si,x,y,w,h}]

function drawBracket() {
  const canvas = document.getElementById('bracketCanvas');
  const { w, h } = computeCanvasSize();
  const dpr = window.devicePixelRatio || 1;
  canvas.width  = w * dpr;
  canvas.height = h * dpr;
  canvas.style.width  = w + 'px';
  canvas.style.height = h + 'px';

  const ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);
  ctx.clearRect(0, 0, w, h);

  hitBoxes = [];

  // Draw each round
  ROUNDS.forEach((rnd, ri) => {
    const colX = getColX(ri);

    // Round header
    ctx.fillStyle = rnd.bg;
    ctx.fillRect(colX, 0, C.BOX_W, C.PAD_TOP - 4);
    ctx.font = 'bold 11px Noto Sans KR, sans-serif';
    ctx.fillStyle = rnd.color;
    ctx.textAlign = 'center';
    ctx.fillText(rnd.label, colX + C.BOX_W/2, 15);
    // header bottom border
    ctx.strokeStyle = rnd.color;
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(colX, C.PAD_TOP - 4);
    ctx.lineTo(colX + C.BOX_W, C.PAD_TOP - 4);
    ctx.stroke();

    // Draw matches
    for (let mi = 0; mi < rnd.n; mi++) {
      const boxY = getBoxY(ri, mi);
      drawMatchBox(ctx, rnd.id, mi, colX, boxY, ri);
    }
  });

  // Draw 3rd place box below final
  const finX = getColX(3);
  const finY = getBoxY(3, 0);
  const thirdY = finY + C.BOX_H + 30;
  // header
  ctx.fillStyle = '#f0f0f0';
  ctx.fillRect(finX, thirdY - 22, C.BOX_W, 20);
  ctx.font = 'bold 11px Noto Sans KR, sans-serif';
  ctx.fillStyle = '#666';
  ctx.textAlign = 'center';
  ctx.fillText('3Â·4ìœ„ì „  15:30', finX + C.BOX_W/2, thirdY - 7);
  ctx.strokeStyle = '#999';
  ctx.lineWidth = 1.5;
  ctx.beginPath(); ctx.moveTo(finX, thirdY - 2); ctx.lineTo(finX+C.BOX_W, thirdY - 2); ctx.stroke();
  drawMatchBox(ctx, '3rd', 0, finX, thirdY, 3, true);

  // Draw connectors
  drawConnectors(ctx);

  // Update cursor
  canvas.style.cursor = isAdmin ? 'pointer' : 'default';
}

function drawMatchBox(ctx, round, mi, x, y, colIdx, is3rd=false) {
  const m = getMatchup(round, mi);
  const wKey = `${round}_${mi}`;
  const wVal = state.winners[wKey];

  // Box shadow effect
  ctx.shadowColor = 'rgba(0,0,0,0.08)';
  ctx.shadowBlur = 6;
  ctx.shadowOffsetY = 2;

  // Box background
  const isFinal = (round==='fin');
  const borderColor = isFinal ? '#c9921a' : is3rd ? '#999' : (wVal!==undefined ? '#1a6b3c' : '#dde4ea');
  roundRect(ctx, x, y, C.BOX_W, C.BOX_H, 8);
  ctx.fillStyle = 'white';
  ctx.fill();
  ctx.shadowColor='transparent'; ctx.shadowBlur=0; ctx.shadowOffsetY=0;
  ctx.strokeStyle = borderColor;
  ctx.lineWidth = wVal!==undefined ? 2 : 1.5;
  ctx.stroke();

  // Label bar
  const labelBg = isFinal ? '#fdecea' : is3rd ? '#f0f0f0' : '#f4f5f7';
  const labelColor = isFinal ? '#c0392b' : '#888';
  ctx.fillStyle = labelBg;
  roundRectTop(ctx, x, y, C.BOX_W, C.LABEL_H, 8);
  ctx.fill();

  ctx.font = 'bold 10px Noto Sans KR, sans-serif';
  ctx.fillStyle = labelColor;
  ctx.textAlign = 'center';
  const labelTxt = round==='fin' ? 'ğŸ† ê²°ìŠ¹ì „' : round==='3rd' ? 'ğŸ¥‰ 3ìœ„ ê²°ì •ì „' :
    round==='r16' ? `${mi+1}ê²½ê¸°` : round==='qf' ? `8ê°• ${mi+1}` : `4ê°• ${mi+1}`;
  ctx.fillText(labelTxt, x + C.BOX_W/2, y + 12);

  // Divider between label and slots
  ctx.strokeStyle = '#eee'; ctx.lineWidth = 1;
  ctx.beginPath(); ctx.moveTo(x, y+C.LABEL_H); ctx.lineTo(x+C.BOX_W, y+C.LABEL_H); ctx.stroke();

  // Slots
  [0,1].forEach(si => {
    const slotY = y + C.LABEL_H + si * C.SLOT_H;
    const isWin = wVal === si;
    const isLose = wVal !== undefined && wVal !== si;
    const hasTeam = m.t[si] !== null;

    // Slot background
    if (isWin) {
      ctx.fillStyle = '#e8f5ee';
      ctx.fillRect(x+1, slotY, C.BOX_W-2, C.SLOT_H - (si===1?1:0));
    } else if (isLose) {
      ctx.fillStyle = '#fafafa';
      ctx.fillRect(x+1, slotY, C.BOX_W-2, C.SLOT_H - (si===1?1:0));
    }

    // Slot divider
    if (si===0) {
      ctx.strokeStyle='#f0f0f0'; ctx.lineWidth=1;
      ctx.beginPath(); ctx.moveTo(x, slotY+C.SLOT_H); ctx.lineTo(x+C.BOX_W, slotY+C.SLOT_H); ctx.stroke();
    }

    // Label badge
    const lblBg = isFinal ? '#fdecea' : is3rd ? '#f0f0f0' : '#e8f5ee';
    const lblColor = isFinal ? '#c0392b' : is3rd ? '#777' : '#1a6b3c';
    ctx.fillStyle = lblBg;
    roundRect(ctx, x+6, slotY+7, 52, 16, 4);
    ctx.fill();
    ctx.font = 'bold 9px Noto Sans KR, sans-serif';
    ctx.fillStyle = lblColor;
    ctx.textAlign = 'left';
    ctx.fillText(m.labels[si], x+9, slotY+18);

    // Team name
    const anyTeam = state.teams.some(t=>t&&t.length>0);
    if (anyTeam && hasTeam) {
      const name = tname(m.t[si]);
      ctx.font = isWin ? 'bold 12px Noto Sans KR' : '12px Noto Sans KR';
      ctx.fillStyle = isWin ? '#1a6b3c' : isLose ? '#bbb' : '#333';
      ctx.textAlign = 'left';
      // Clip long names
      const maxW = C.BOX_W - 70;
      let txt = name;
      while (ctx.measureText(txt).width > maxW && txt.length > 1) txt = txt.slice(0,-1);
      if (txt !== name) txt += 'â€¦';
      ctx.fillText(txt, x + 64, slotY + 19);

      // Win crown
      if (isWin) {
        ctx.font = '12px sans-serif';
        ctx.textAlign = 'right';
        ctx.fillText('âœ…', x + C.BOX_W - 5, slotY + 19);
      }
    } else if (!anyTeam) {
      // No teams entered â€” just show label, no name
    }

    // Hit detection (admin only)
    hitBoxes.push({ round, mi, si, x, y: slotY, w: C.BOX_W, h: C.SLOT_H });
  });
}

function drawConnectors(ctx) {
  ctx.strokeStyle = '#ccc';
  ctx.lineWidth = 2;

  // For each transition r16â†’qf, qfâ†’sf, sfâ†’fin
  const pairs = [
    ['r16', 'qf', 8, 4, 0, 1],
    ['qf',  'sf', 4, 2, 1, 2],
    ['sf',  'fin',2, 1, 2, 3],
  ];

  pairs.forEach(([fromRnd, toRnd, fromN, toN, fromCol, toCol]) => {
    const fromX = getColX(fromCol) + C.BOX_W;
    const toX   = getColX(toCol);
    const midX  = fromX + C.COL_GAP / 2;

    for (let qi = 0; qi < toN; qi++) {
      // Two source boxes â†’ one target box
      const srcA = getBoxY(fromCol, qi*2)   + C.BOX_H/2;
      const srcB = getBoxY(fromCol, qi*2+1) + C.BOX_H/2;
      const tgt  = getBoxY(toCol, qi)       + C.BOX_H/2;

      ctx.beginPath();
      // From box A â†’ mid vertical
      ctx.moveTo(fromX, srcA);
      ctx.lineTo(midX, srcA);
      ctx.lineTo(midX, tgt);
      // From box B â†’ mid vertical
      ctx.moveTo(fromX, srcB);
      ctx.lineTo(midX, srcB);
      ctx.lineTo(midX, tgt);
      // Mid â†’ target box
      ctx.moveTo(midX, tgt);
      ctx.lineTo(toX, tgt);
      ctx.stroke();
    }
  });
}

// ---- Utility: rounded rect ----
function roundRect(ctx, x, y, w, h, r) {
  ctx.beginPath();
  ctx.moveTo(x+r, y);
  ctx.lineTo(x+w-r, y); ctx.arcTo(x+w,y,x+w,y+r,r);
  ctx.lineTo(x+w, y+h-r); ctx.arcTo(x+w,y+h,x+w-r,y+h,r);
  ctx.lineTo(x+r, y+h); ctx.arcTo(x,y+h,x,y+h-r,r);
  ctx.lineTo(x, y+r); ctx.arcTo(x,y,x+r,y,r);
  ctx.closePath();
}
function roundRectTop(ctx, x, y, w, h, r) {
  ctx.beginPath();
  ctx.moveTo(x+r, y);
  ctx.lineTo(x+w-r, y); ctx.arcTo(x+w,y,x+w,y+r,r);
  ctx.lineTo(x+w, y+h);
  ctx.lineTo(x, y+h);
  ctx.lineTo(x, y+r); ctx.arcTo(x,y,x+r,y,r);
  ctx.closePath();
}

// ---- Click handler ----
function handleCanvasClick(e) {
  if (!isAdmin) return;
  const canvas = document.getElementById('bracketCanvas');
  const rect = canvas.getBoundingClientRect();
  const cx = (e.clientX - rect.left);
  const cy = (e.clientY - rect.top);

  for (const hb of hitBoxes) {
    if (cx>=hb.x && cx<=hb.x+hb.w && cy>=hb.y && cy<=hb.y+hb.h) {
      const m = getMatchup(hb.round, hb.mi);
      // Only clickable if the team is actually resolved
      if (m.t[hb.si] !== null) {
        setWinner(hb.round, hb.mi, hb.si);
      }
      return;
    }
  }
}

// ============================================================
// RENDER ALL
// ============================================================
function renderAll() {
  renderPrelim();
  drawBracket();
  const hasTeams = state.teams.some(t=>t&&t.length>0);
  document.getElementById('bracketNote').style.display = hasTeams ? 'none' : 'block';
}

// ============================================================
// TAB
// ============================================================
function switchTab(tab) {
  document.querySelectorAll('.tab-content').forEach(el=>el.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(el=>el.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  document.querySelector(`.tab-btn.${tab==='poster'?'t1':'t2'}`).classList.add('active');
  if (tab==='bracket') drawBracket();
}

// ============================================================
// INIT
// ============================================================
document.getElementById('bracketCanvas').addEventListener('click', handleCanvasClick);
window.addEventListener('resize', ()=>{ if (document.getElementById('bracket').classList.contains('active')) drawBracket(); });

loadLocal();
buildTeamInputs();
renderAll();
initFirebase().then(ok=>{
  if (!ok) {
    setSyncStatus('ğŸ’¾ ë¡œì»¬ ëª¨ë“œ (Firebase ë¯¸ì„¤ì •)');
  }
});
</script>
</body>
</html>
